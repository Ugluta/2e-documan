<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>2e-documan | Deep Agent Elite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
</head>
<body class="bg-slate-100 text-slate-900 overflow-hidden">
    <div class="flex h-screen">
        <aside class="w-72 bg-slate-900 text-white p-8 shadow-2xl flex flex-col">
            <h1 class="text-3xl font-black italic text-blue-500 mb-10 tracking-tighter">2e-documan</h1>
            <nav class="space-y-4 flex-1">
                <button onclick="showTab('ai-engine')" class="w-full text-left p-4 rounded-xl bg-blue-600 font-bold transition">ğŸš€ AI Analiz Motoru</button>
                <button onclick="fetchMEBNews()" class="w-full text-left p-4 rounded-xl hover:bg-slate-800 transition">ğŸ“° MEB Haber Botu</button>
                <button onclick="showTab('settings')" class="w-full text-left p-4 rounded-xl hover:bg-slate-800 transition">âš™ï¸ Sistem AyarlarÄ±</button>
            </nav>
            <div class="text-xs text-slate-500 border-t border-slate-800 pt-4">Status: Deep Agent Active v3</div>
        </aside>

        <main class="flex-1 p-12 overflow-y-auto">
            <div id="ai-engine" class="tab-content">
                <div class="flex justify-between items-end mb-8">
                    <h2 class="text-4xl font-bold">Deep Agent Motoru</h2>
                    <p class="text-slate-500">PDF yÃ¼kle, zekayÄ± gÃ¶r.</p>
                </div>
                <div class="bg-white p-16 rounded-[40px] shadow-2xl border-4 border-dashed border-blue-100 text-center">
                    <input type="file" id="pdf-input" accept=".pdf" class="hidden" onchange="runMercedes()">
                    <label for="pdf-input" class="cursor-pointer bg-slate-900 text-white px-12 py-5 rounded-2xl font-black text-xl hover:bg-blue-600 transition-all inline-block shadow-lg">DÃ–KÃœMANI ATEÅLE</label>
                </div>
                <div id="ai-output" class="mt-10 bg-white rounded-3xl p-10 shadow-xl hidden animate-pulse">Analiz bekleniyor...</div>
            </div>

            <div id="news-bot" class="tab-content hidden">
                <h2 class="text-4xl font-bold mb-8">MEB Haber RadarÄ±</h2>
                <div id="news-list" class="grid gap-6">
                    <p class="italic text-slate-500">Haberler taranÄ±yor...</p>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        const API_KEY = "AIzaSyD8_Xd2wmTN8RmVuTLbzPkJaWq0okbQBuU"; // <-- BurayÄ± gÃ¼ncelle baboÅŸ
        const genAI = new GoogleGenerativeAI(API_KEY);
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        window.showTab = (id) => {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        };

        window.runMercedes = async () => {
            const file = document.getElementById('pdf-input').files[0];
            const output = document.getElementById('ai-output');
            output.classList.remove('hidden', 'animate-pulse');
            output.innerHTML = "<span class='text-blue-600 font-bold'>Deep Agent PDF'i parÃ§alÄ±yor...</span>";
            
            const reader = new FileReader();
            reader.onload = async function() {
                const pdf = await pdfjsLib.getDocument(new Uint8Array(this.result)).promise;
                let text = "";
                for(let i=1; i<=Math.min(pdf.numPages, 2); i++){
                    const page = await pdf.getPage(i);
                    const content = await page.getTextContent();
                    text += content.items.map(s => s.str).join(" ");
                }
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                const result = await model.generateContent("Ã–ÄŸretmenler iÃ§in bu PDF'i analiz et ve profesyonel bir bÃ¼lten baÅŸlÄ±ÄŸÄ± Ã§Ä±kar: " + text);
                output.innerHTML = `<h3 class='text-2xl font-bold mb-4 border-b pb-2 text-blue-600'>AI ANALÄ°Z RAPORU</h3><div class='leading-relaxed text-lg'>${result.response.text().replace(/\n/g, '<br>')}</div>`;
            };
            reader.readAsArrayBuffer(file);
        };

        window.fetchMEBNews = async () => {
            showTab('news-bot');
            const list = document.getElementById('news-list');
            const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
            const result = await model.generateContent("MEB gÃ¼ndemindeki en yeni 3 eÄŸitim haberini baÅŸlÄ±klar halinde uydurmadan listele.");
            list.innerHTML = `<div class='bg-blue-50 p-8 rounded-2xl border border-blue-200'>${result.response.text().replace(/\n/g, '<br>')}</div>`;
        };
    </script>
</body>
</html>